<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Medical Calendar</title>
</head>
<body>
  <div style="display: flex; flex-direction: column; align-items: center; margin-top: 40px;">
    <h1>Welcome! Here's your medical calendar</h1>
    <h2 id="monthYear" style="font-size: 24px;"></h2>
    <table id="calendar" border="1" cellspacing="0" cellpadding="10" style="font-size: 20px; border-collapse: collapse; text-align: center; width: 500px; height: 400px;"></table>
    <br>
    <div>
      <button onclick="prevMonth()" style="font-size: 18px; padding: 8px 12px;">&larr; Back</button>
      <button onclick="nextMonth()" style="font-size: 18px; padding: 8px 12px;">Next &rarr;</button>
    </div>
  </div>

  <script>
  console.log("xd");
    const calendar = document.getElementById('calendar');
    const monthYear = document.getElementById('monthYear');

    let currentDate = new Date();
    let userActivity = null; // Variable to store the fetched physical activity value

    // Fetch the user's physical activity from the backend
    fetch('/user-data')
      .then(res => res.json())
      .then(data => {
        console.log('User Physical Activity:', data.physicalActivity); // Log the fetched physical activity data
        userActivity = data.physicalActivity; // Store the physical activity
      });
	      function renderCalendar(date) {
      const year = date.getFullYear();
      const month = date.getMonth();
      const firstDay = new Date(year, month, 1).getDay();
      const daysInMonth = new Date(year, month + 1, 0).getDate();

      const monthNames = [
        "January", "February", "March", "April", "May", "June",
        "July", "August", "September", "October", "November", "December"
      ];
      monthYear.textContent = `${monthNames[month]} ${year}`;

      calendar.innerHTML = "";

      const days = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
      let headerRow = "<tr>" + days.map(d => `<th>${d}</th>`).join("") + "</tr>";
      calendar.innerHTML += headerRow;

      let row = "<tr>";
      for (let i = 0; i < firstDay; i++) {
        row += "<td></td>";
      }

      // Add each day to the calendar and color it based on the user's physical activity
      for (let day = 1; day <= daysInMonth; day++) {
        let dayClass = "";  // Default to no special class

        // If user has physical activity marked as "yes", color certain dates
        if (userActivity === "yes") {
          // For demonstration, let's color the 15th day if physical activity is "yes"
          if (day === 15) {
            dayClass = "badanie-date";  // Mark this day for special coloring
          }
        }
		else
		{
			if (day === 20) 
			{
            dayClass = "badanie-date";  // Mark this day for special coloring
			}
		}

        // Add the day to the row, with the corresponding class for special styling
        row += `<td class="${dayClass}">${day}</td>`;

        if ((firstDay + day) % 7 === 0) {
          row += "</tr><tr>";
        }
      }

      row += "</tr>";
      calendar.innerHTML += row;
    }

    function nextMonth() {
      currentDate.setMonth(currentDate.getMonth() + 1);
      renderCalendar(currentDate);
    }

    function prevMonth() {
      currentDate.setMonth(currentDate.getMonth() - 1);
      renderCalendar(currentDate);
    }

    renderCalendar(currentDate);

  </script>
    <style>
    /* Add CSS for coloring the specific day (for example the 15th day) */
    .badanie-date {
      background-color: lightgreen; /* Color the active days with light green */
    }
  </style>

</body>
</html>